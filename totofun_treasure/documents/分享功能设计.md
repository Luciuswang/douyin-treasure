# 📤 Totofun 分享功能设计方案

## 🎯 设计目标

1. **病毒式传播** - 让用户主动分享，带来新用户
2. **任务完成激励** - 分享作为任务完成条件
3. **社交裂变** - 通过分享获得额外奖励
4. **品牌曝光** - 提升App和商家品牌知名度

---

## 📋 方案对比

| 特性 | 方案A：外部分享 | 方案B：内置社区 |
|------|----------------|----------------|
| 开发成本 | ⭐ 低 | ⭐⭐⭐⭐⭐ 高 |
| 传播范围 | ⭐⭐⭐⭐⭐ 广 | ⭐⭐ 窄（初期） |
| 用户粘性 | ⭐⭐ 低 | ⭐⭐⭐⭐ 高 |
| 获客成本 | ⭐⭐⭐⭐⭐ 低 | ⭐⭐⭐ 中 |
| 内容审核 | ⭐⭐⭐⭐⭐ 无需 | ⭐ 需要 |
| 数据掌控 | ⭐⭐ 低 | ⭐⭐⭐⭐⭐ 高 |

### 推荐：分阶段实施

**MVP阶段（现在）：方案A - 外部分享**
- 快速上线
- 验证产品模式
- 获取初始用户

**成长阶段（有一定用户量后）：方案B - 内置社区**
- 增强用户粘性
- 建立社交关系链
- 形成闭环生态

---

## 🚀 方案A：外部分享（MVP实施方案）

### 1. 分享场景

#### 场景1：任务分享
**触发点**：
- 接取任务后
- 完成任务获得奖励时
- 发现高价值任务时

**分享内容**：
```
🎁 我在【Totofun突突翻】发现了超值任务！

📍 商家：星巴克咖啡
🎯 任务：到店打卡
💰 奖励：50经验 + 10金币 + 满30减5券

快来一起赚奖励吧！
下载链接：https://totofun.com/download?ref=USER_ID&task=TASK_ID
```

#### 场景2：战绩分享
**触发点**：
- 升级时
- 完成特殊成就时
- 累计收益达到里程碑

**分享内容**：
```
🎉 我在【Totofun突突翻】等级提升了！

⭐ 等级：Lv.10
💰 累计收益：500金币
🎁 完成任务：50个
🏆 获得优惠券：价值200元

一起来玩吧！
下载链接：https://totofun.com/download?ref=USER_ID
```

#### 场景3：邀请好友
**触发点**：
- 用户主动邀请
- 完成"邀请好友"任务

**分享内容**：
```
💎 邀你一起玩【Totofun突突翻】

🎮 边玩边赚，完成任务得奖励
🏪 线下商家联合，优惠券拿到手软
🎁 新用户专属礼包等你来拿

使用我的邀请码：ABC123
下载链接：https://totofun.com/download?ref=USER_ID
```

#### 场景4：商家推广
**触发点**：
- 商家发布任务后
- 商家获得新客户时

**分享内容**：
```
📣 【星巴克咖啡】在Totofun发布新任务啦！

🎯 到店打卡即送满30减5券
💰 名额有限，先到先得
📍 地址：XX市XX区XX路100号

快来参与吧！
活动链接：https://totofun.com/task/TASK_ID
```

---

### 2. 技术实现

#### 依赖包
```yaml
dependencies:
  share_plus: ^7.2.1  # 分享功能
  url_launcher: ^6.2.2  # 打开外部链接
  qr_flutter: ^4.1.0  # 生成二维码（已有）
  path_provider: ^2.1.1  # 文件存储
  screenshot: ^2.1.0  # 截图分享
```

#### 核心功能类
```dart
class ShareService {
  // 1. 分享任务
  Future<void> shareTask(Task task, User user) async {
    final text = '''
🎁 我在【Totofun突突翻】发现了超值任务！

📍 商家：${task.merchantName}
🎯 任务：${task.title}
💰 奖励：${task.experience}经验 + ${task.coins}金币
${task.coupon != null ? '🎁 ${task.coupon}' : ''}

快来一起赚奖励吧！
下载链接：https://totofun.com/download?ref=${user.id}&task=${task.id}
    ''';
    
    await Share.share(text);
  }

  // 2. 分享战绩（带图片）
  Future<void> shareAchievement(User user) async {
    // 生成战绩图片
    final image = await _generateAchievementImage(user);
    
    final text = '''
🎉 我在【Totofun突突翻】等级提升了！

⭐ 等级：Lv.${user.level}
💰 累计收益：${user.coins}金币

一起来玩吧！
下载链接：https://totofun.com/download?ref=${user.id}
    ''';
    
    await Share.shareXFiles(
      [XFile(image.path)],
      text: text,
    );
  }

  // 3. 生成邀请海报
  Future<File> generateInvitePoster(User user) async {
    // 使用 screenshot 包生成精美海报
    // 包含：用户头像、邀请码、二维码、奖励说明
  }

  // 4. 复制邀请链接
  Future<void> copyInviteLink(String userId) async {
    final link = 'https://totofun.com/download?ref=$userId';
    await Clipboard.setData(ClipboardData(text: link));
  }
}
```

---

### 3. 分享奖励机制

#### 分享者奖励
- **分享任务** → 5金币（每天最多3次）
- **好友注册** → 50金币 + 10经验
- **好友完成首个任务** → 20金币
- **好友充值/消费** → 返现5%

#### 被邀请者奖励
- **新用户注册** → 新手礼包（100金币 + 3张券）
- **首次完成任务** → 双倍奖励
- **前10个任务** → 额外20%奖励

#### 商家奖励
- **任务被分享** → 曝光量统计
- **通过分享获客** → 降低单次推广费
- **分享达到阈值** → 免费推广机会

---

### 4. UI设计

#### 分享按钮位置
1. **任务详情页** - 右上角分享按钮
2. **任务完成页** - "分享战绩"按钮
3. **个人中心** - "邀请好友"入口
4. **商家后台** - "分享任务"按钮

#### 分享弹窗选项
```
┌─────────────────────────┐
│    分享到哪里？          │
├─────────────────────────┤
│ 📱 微信好友             │
│ 👥 微信朋友圈           │
│ 📘 QQ好友               │
│ 🌐 QQ空间               │
│ 🎵 抖音                 │
│ 📸 小红书               │
│ 📋 复制链接             │
│ 🖼️ 保存海报             │
└─────────────────────────┘
```

---

## 🏢 方案B：内置社区（未来规划）

### 1. 功能模块

#### 广场
- 动态流（瀑布流）
- 热门动态
- 附近动态
- 好友动态

#### 发布
- 文字动态
- 图片动态
- 任务分享卡片
- 战绩分享卡片

#### 互动
- 点赞
- 评论
- 转发
- 收藏

#### 社交关系
- 关注/粉丝
- 好友系统
- 俱乐部/工会
- 私信

---

### 2. 内容类型

#### UGC内容
- **攻略分享** - 任务完成技巧
- **探店日记** - 商家打卡体验
- **战绩炫耀** - 收益、等级展示
- **活动组队** - 约人一起做任务
- **吐槽反馈** - 商家服务评价

#### PGC内容（官方）
- **活动公告** - 限时活动
- **新商家推荐** - 优质商家
- **玩法教程** - 新手指南
- **每日推荐** - 高价值任务

---

### 3. 激励机制

#### 发布奖励
- 发布动态 → 2金币
- 分享任务 → 5金币
- 优质内容（高赞） → 20-100金币
- 上榜热门 → 特殊徽章

#### 互动奖励
- 点赞他人 → 1经验（每天限10次）
- 评论互动 → 2经验
- 动态被点赞 → 1金币/赞
- 粉丝增长 → 等级奖励

---

### 4. 内容审核

#### 自动审核
- 敏感词过滤
- 图片鉴黄
- 违禁内容检测

#### 人工审核
- 举报处理
- 热门内容复审
- 商家内容审核

#### 用户举报
- 垃圾广告
- 违规内容
- 虚假信息

---

## 📊 数据监控指标

### 分享效果
- **分享率** = 分享人数 / DAU
- **分享转化率** = 新增注册 / 分享次数
- **病毒系数K** = 每个用户平均带来的新用户数

### 目标
- 分享率 > 15%
- 分享转化率 > 10%
- 病毒系数K > 1.2

---

## 🛠️ 开发优先级

### P0（立即实施）
- [x] 基础分享功能（text）
- [ ] 任务分享
- [ ] 邀请好友
- [ ] 分享奖励机制

### P1（短期规划）
- [ ] 战绩分享（带图）
- [ ] 邀请海报生成
- [ ] 分享数据统计
- [ ] A/B测试不同文案

### P2（中期规划）
- [ ] 内置社区广场
- [ ] 动态发布
- [ ] 社交关系链
- [ ] 内容推荐算法

### P3（长期规划）
- [ ] 短视频分享
- [ ] 直播功能
- [ ] 社群功能
- [ ] KOL达人体系

---

## 💡 创新想法

### 1. AR分享
用户完成任务时，可以拍摄AR特效照片分享
- 虚拟宝箱开启特效
- 升级烟花动画
- 商家专属AR贴纸

### 2. 社交裂变玩法
- **拼团任务** - 3人一起完成，奖励翻倍
- **助力任务** - 好友助力解锁高价值任务
- **PK对战** - 好友比拼任务完成数

### 3. 内容创作者计划
- 优质内容创作者分成
- 探店达人认证
- 品牌合作机会

---

## 🎯 总结

**MVP阶段（现在）：**
- 实施方案A - 外部分享
- 重点：任务分享 + 邀请好友
- 目标：验证模式、快速获客

**成长阶段（3-6个月后）：**
- 实施方案B - 内置社区
- 重点：用户粘性 + 社交关系
- 目标：形成生态闭环

---

*文档版本：v1.0*  
*最后更新：2025-01-30*

